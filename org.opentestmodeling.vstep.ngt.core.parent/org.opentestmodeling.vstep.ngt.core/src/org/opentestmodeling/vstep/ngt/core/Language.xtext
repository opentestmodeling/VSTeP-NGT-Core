// automatically generated by Xtext
grammar org.opentestmodeling.vstep.ngt.core.Language with org.eclipse.xtext.common.Terminals


generate language "http://www.opentestmodeling.org/vstep/ngt/core/Language"

Model:
    (imports += TopLevelImport)*
    (testElements += TestElement)*;

//
// Import external models.
//
TopLevelImport:
    'import' importURI = STRING;


//
// Test container related.
//
TestElement: TestTarget | TestViewpoint | NodeConnection | TestContainer;

TestContainer:
    'container' name=ID_CONTAINER ( shortDesc = STRING )? '{'
        elements += TestElement ( elements += TestElement )*
    '}';


NodeRef: TargetRef | ViewpointRef;

TargetRef: ref = [TestTarget|ID_TARGET];
ViewpointRef: ref = [TestViewpoint|ID_VIEWPOINT];

//
// Connection related.
//
NodeConnection: '&' (Inheritance | Relation | Dependency);

Inheritance: Inheritance1 | Inheritance2;

Inheritance1:
    superNode = [TestTarget|ID_TARGET] (name = '<|--' | name = '<|-' stereotype=ID_STEREOTYPE '-') sub = NodeRef;
Inheritance2:
    superNode = [TestViewpoint|ID_VIEWPOINT] (name = '<|--' | name = '<|-' stereotype=ID_STEREOTYPE '-') sub = [TestViewpoint|ID_VIEWPOINT];
	
Relation:
    dst = NodeRef ('....' | '..' stereotype=ID_STEREOTYPE '..') src = NodeRef;

Dependency:
    dst = NodeRef (name = '<--' | name = '<-' stereotype=ID_STEREOTYPE '-') src = NodeRef;

//
// Node related.
//
TestTarget:
    name = ID_TARGET
    (
            ( stereotype = ID_STEREOTYPE )? &
            ( shortDesc = STRING )?
    );

TestViewpoint:
    name = ID_VIEWPOINT
    (
            ( stereotype = ID_STEREOTYPE )? &
            ( shortDesc = STRING)?
    )
    (detail = ViewpointDetail)?;

ViewpointDetail: {ViewpointDetail} '{'
         ((testItems = ItemList)? &
          (qualityRisk = QualityRisk)? &
          (coverage = STRING)?
         )
'}';

ItemList:
    {ItemList} 'items' '{' elements += STRING (elements += STRING)* '}';

QualityRisk: {QualityRisk}
    'quality-risk' '{'
    (
            ('importance' '=' importance=INT)? &
              ('severity' '=' severity=INT)?
    )
    '}';

terminal ID_TARGET: '(' ( '\\' . | !('\\'|')') )+ ')';
terminal ID_VIEWPOINT: '[' ( '\\' . | !('\\'|']') )+ ']';
terminal ID_STEREOTYPE: '<<' ( '\\' . | !('\\'|'>') )+ '>>';
terminal ID_CONTAINER: ('a'..'z'|'A'..'Z'|'_'|'\u0080'..'\uFFFD')('a'..'z'|'A'..'Z'|'_'|'0'..'9'|'\u0080'..'\uFFFD')*;
